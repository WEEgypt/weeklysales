<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width,initial-scale=0.95,maximum-scale=1,user-scalable=no" />
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
        <title>Weekly Sales</title>
        <link rel="icon" href="icon.png" />
        <link rel="apple-touch-icon" href="icon.png" />
        <link rel="stylesheet" href="style.css" />
    </head>
    <body onload="GetDate()">
        <div class="mainDiv">
            <form method="post" name="Agent" id="Agent">
                <h2>Weekly Sales</h2>
                <table>
                    <tr>
                        <td><label>Sales Till</label></td>
                        <td>
                            <select id="day">
                                <option value="" selected disabled hidden>Day</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                                <option value="13">13</option>
                                <option value="14">14</option>
                                <option value="15">15</option>
                                <option value="16">16</option>
                                <option value="17">17</option>
                                <option value="18">18</option>
                                <option value="19">19</option>
                                <option value="20">20</option>
                                <option value="21">21</option>
                                <option value="22">22</option>
                                <option value="23">23</option>
                                <option value="24">24</option>
                                <option value="25">25</option>
                                <option value="26">26</option>
                                <option value="27">27</option>
                                <option value="28">28</option>
                                <option value="29">29</option>
                                <option value="30">30</option>
                                <option value="31">31</option>
                            </select>
                        </td>
                        <td>
                            <select id="month" onchange="DaysFix()">
                                <option value="" selected disabled hidden>Month</option>
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                        </td>
                        <td>
                            <input type="number" id="year" hidden />
                        </td>
                    </tr>
                    <tr>
                        <td><label>Store</label></td>
                        <td colspan="2">
                            <select name="Store" id="store">
                                <option value="" selected disabled hidden>Store Name</option>
                                <option value="شرق النيل">شرق النيل</option>
                                <option value="نادى التجديف">نادى التجديف</option>
                                <option value="بيت الرحمه">بيت الرحمه</option>
                                <option value="الشهيد">الشهيد</option>
                                <option value="اخميم">اخميم</option>
                                <option value="المنشاه">المنشاه</option>
                                <option value="جرجا - المصريه جروب">جرجا - المصريه جروب</option>
                                <option value="جرجا - فيوتشر">جرجا - فيوتشر</option>
                                <option value="البلينا - فيوتشر">البلينا - فيوتشر</option>
                                <option value="البلينا - تليكوم">البلينا - تليكوم</option>
                                <option value="دار السلام">دار السلام</option>
                                <option value="طهطا - المصريه جروب">طهطا - المصريه جروب</option>
                                <option value="طهطا - فيوتشر">طهطا - فيوتشر</option>
                                <option value="المراغه - المصريه جروب">المراغه - المصريه جروب</option>
                                <option value="المراغه - فيوتشر">المراغه - فيوتشر</option>
                                <option value="طما - فيوتشر">طما - فيوتشر</option>
                                <option value="طما - كافريج">طما - كافريج</option>
                                <option value="مجمع المحاكم">مجمع المحاكم</option>
                                <option value="شارع 15">شارع 15</option>
                                <option value="المخبز الآلي">المخبز الآلي</option>
                                <option value="جهينه">جهينه</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Agent</label></td>
                        <td colspan="2"><input type="text" class="Agent-Name" name="Agent Name" id="Agent Name" placeholder="Enter your name" /></td>
                    </tr>
                    <input type="text" name="Sales Till" id="Sales Till" hidden />
                    <input type="number" name="Mobile ACH" id="Mobile ACH" hidden />
                    <input type="number" name="Mobile TARGET" id="Mobile TARGET" hidden />
                    <input type="text" name="Mobile VS" id="Mobile VS" hidden />
                    <input type="text" name="Mobile RE" id="Mobile RE" hidden />
                    <input type="text" name="We Gold VS" id="We Gold VS" hidden />
                    <input type="text" name="We Gold RE" id="We Gold RE" hidden />
                    <input type="text" name="ADSL VS" id="ADSL VS" hidden />
                    <input type="text" name="ADSL RE" id="ADSL RE" hidden />
                    <input type="text" name="Fixed VS" id="Fixed VS" hidden />
                    <input type="text" name="Fixed RE" id="Fixed RE" hidden />
                    <tr>
                        <td class="space"></td>
                        <td class="space"></td>
                        <td class="space"></td>
                    </tr>
                    <tr class="header">
                        <td><b>Item</b></td>
                        <td><b>Achieved</b></td>
                        <td><b>Target</b></td>
                    </tr>
                    <tr>
                        <td><label>PAYG</label></td>
                        <td><input type="number" name="PAYG ACH" id="PAYG ACH" /></td>
                        <td><input type="number" name="PAYG TARGET" id="PAYG TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>Data</label></td>
                        <td><input type="number" name="Data ACH" id="Data ACH" /></td>
                        <td><input type="number" name="Data TARGET" id="Data TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>Kix</label></td>
                        <td><input type="number" name="Kix ACH" id="Kix ACH" /></td>
                        <td><input type="number" name="Kix TARGET" id="Kix TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>Tazbeet</label></td>
                        <td><input type="number" name="Tazbeet ACH" id="Tazbeet ACH" /></td>
                        <td><input type="number" name="Tazbeet TARGET" id="Tazbeet TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>We Club</label></td>
                        <td><input type="number" name="We Club ACH" id="We Club ACH" /></td>
                        <td><input type="number" name="We Club TARGET" id="We Club TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>We Mix</label></td>
                        <td><input type="number" name="We Mix ACH" id="We Mix ACH" /></td>
                        <td><input type="number" name="We Mix TARGET" id="We Mix TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>We Gold</label></td>
                        <td><input type="number" name="We Gold ACH" id="We Gold ACH" /></td>
                        <td><input type="number" name="We Gold TARGET" id="We Gold TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>ADSL</label></td>
                        <td><input type="number" name="ADSL ACH" id="ADSL ACH" /></td>
                        <td><input type="number" name="ADSL TARGET" id="ADSL TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>Fixed</label></td>
                        <td><input type="number" name="Fixed ACH" id="Fixed ACH" /></td>
                        <td><input type="number" name="Fixed TARGET" id="Fixed TARGET" /></td>
                    </tr>
                </table>
                <br />
                <input style="display: none;" id="submit" type="submit" value="Submit" />
                <button type="button" id="checkandsubmit" onclick="checkInput()">Submit</button>
                <button type="button" id="another" onclick="Another()" hidden>Another one</button>
                <br />
                <br />
            </form>
        </div>
        <script>
            function GetDate() {
                document.getElementById("month").value = new Date().getMonth() + 1;
                document.getElementById("year").value = new Date().getFullYear();
                DaysFix();
            }
            function DaysFix() {
                var daysinmonth = new Date(document.getElementById("year").value, document.getElementById("month").value, 0).getDate();
                if (daysinmonth < 31 && document.getElementById("day").value == 31) {
                    document.getElementById("day").selectedIndex = "30";
                }
                if (daysinmonth < 30 && document.getElementById("day").value == 30) {
                    document.getElementById("day").selectedIndex = "29";
                }
                if (daysinmonth < 29 && document.getElementById("day").value == 29) {
                    document.getElementById("day").selectedIndex = "28";
                }
                if (daysinmonth < 31 && document.getElementById("day").length == "32") {
                    const list = document.getElementById("day");
                    list.removeChild(list.lastElementChild);
                }
                if (daysinmonth < 30 && document.getElementById("day").length == "31") {
                    const list = document.getElementById("day");
                    list.removeChild(list.lastElementChild);
                }
                if (daysinmonth < 29 && document.getElementById("day").length == "30") {
                    const list = document.getElementById("day");
                    list.removeChild(list.lastElementChild);
                }
                if (daysinmonth == 31 && document.getElementById("day").length == "31") {
                    document.getElementById("day").options.add(new Option("31", "31"));
                }
                if (daysinmonth == 31 && document.getElementById("day").length == "30") {
                    document.getElementById("day").options.add(new Option("30", "30"));
                    document.getElementById("day").options.add(new Option("31", "31"));
                }
                if (daysinmonth == 31 && document.getElementById("day").length == "29") {
                    document.getElementById("day").options.add(new Option("29", "29"));
                    document.getElementById("day").options.add(new Option("30", "30"));
                    document.getElementById("day").options.add(new Option("31", "31"));
                }
                if (daysinmonth == 30 && document.getElementById("day").length == "30") {
                    document.getElementById("day").options.add(new Option("30", "30"));
                }
                if (daysinmonth == 30 && document.getElementById("day").length == "29") {
                    document.getElementById("day").options.add(new Option("29", "29"));
                    document.getElementById("day").options.add(new Option("30", "30"));
                }
                if (daysinmonth == 29 && document.getElementById("day").length == "29") {
                    document.getElementById("day").options.add(new Option("29", "29"));
                }
            }
            function checkInput() {
                if (document.getElementById("day").value == "") {
                    document.getElementById("day").focus();
                    return false;
                } else if (document.getElementById("store").value == "") {
                    document.getElementById("store").focus();
                    return false;
                } else if (document.getElementById("Agent Name").value == "") {
                    document.getElementById("Agent Name").focus();
                    return false;
                } else if (document.getElementById("PAYG ACH").value == "") {
                    document.getElementById("PAYG ACH").focus();
                    return false;
                } else if (document.getElementById("PAYG TARGET").value == "") {
                    document.getElementById("PAYG TARGET").focus();
                    return false;
                } else if (document.getElementById("Data ACH").value == "") {
                    document.getElementById("Data ACH").focus();
                    return false;
                } else if (document.getElementById("Data TARGET").value == "") {
                    document.getElementById("Data TARGET").focus();
                    return false;
                } else if (document.getElementById("Kix ACH").value == "") {
                    document.getElementById("Kix ACH").focus();
                    return false;
                } else if (document.getElementById("Kix TARGET").value == "") {
                    document.getElementById("Kix TARGET").focus();
                    return false;
                } else if (document.getElementById("Tazbeet ACH").value == "") {
                    document.getElementById("Tazbeet ACH").focus();
                    return false;
                } else if (document.getElementById("Tazbeet TARGET").value == "") {
                    document.getElementById("Tazbeet TARGET").focus();
                    return false;
                } else if (document.getElementById("We Club ACH").value == "") {
                    document.getElementById("We Club ACH").focus();
                    return false;
                } else if (document.getElementById("We Club TARGET").value == "") {
                    document.getElementById("We Club TARGET").focus();
                    return false;
                } else if (document.getElementById("We Mix ACH").value == "") {
                    document.getElementById("We Mix ACH").focus();
                    return false;
                } else if (document.getElementById("We Mix TARGET").value == "") {
                    document.getElementById("We Mix TARGET").focus();
                    return false;
                } else if (document.getElementById("We Gold ACH").value == "") {
                    document.getElementById("We Gold ACH").focus();
                    return false;
                } else if (document.getElementById("We Gold TARGET").value == "") {
                    document.getElementById("We Gold TARGET").focus();
                    return false;
                } else if (document.getElementById("ADSL ACH").value == "") {
                    document.getElementById("ADSL ACH").focus();
                    return false;
                } else if (document.getElementById("ADSL TARGET").value == "") {
                    document.getElementById("ADSL TARGET").focus();
                    return false;
                } else if (document.getElementById("Fixed ACH").value == "") {
                    document.getElementById("Fixed ACH").focus();
                    return false;
                } else if (document.getElementById("Fixed TARGET").value == "") {
                    document.getElementById("Fixed TARGET").focus();
                    return false;
                } else {
                    document.getElementById("submit").click();
                }
            }
            document.getElementById("Agent").onkeypress = function (e) {
                var key = e.charCode || e.keyCode || 0;
                if (key == 13) {
                    e.preventDefault();
                }
            };
            const ScriptURL = "https://script.google.com/macros/s/AKfycbwiq-WU1DufWXco0VqpoFlijVavMHaVhqwaNKLilCnRDCxBgiFyy435QDZgaRle9p2cPg/exec?sheetName=Weekly";
            const salesForm = document.forms["Agent"];
            salesForm.addEventListener("submit", (e) => {
                document.getElementById("checkandsubmit").disabled = true;
                document.getElementById("checkandsubmit").innerHTML = "Sending";
                e.preventDefault();
                document.getElementById("Sales Till").value = document.getElementById("day").value + "/" + document.getElementById("month").value + "/" + document.getElementById("year").value;
                document.getElementById("Mobile ACH").value =
                    Number(document.getElementById("PAYG ACH").value) +
                    Number(document.getElementById("Data ACH").value) +
                    Number(document.getElementById("Kix ACH").value) +
                    Number(document.getElementById("Tazbeet ACH").value) +
                    Number(document.getElementById("We Club ACH").value) +
                    Number(document.getElementById("We Mix ACH").value) +
                    Number(document.getElementById("We Gold ACH").value);
                document.getElementById("Mobile TARGET").value =
                    Number(document.getElementById("PAYG TARGET").value) +
                    Number(document.getElementById("Data TARGET").value) +
                    Number(document.getElementById("Kix TARGET").value) +
                    Number(document.getElementById("Tazbeet TARGET").value) +
                    Number(document.getElementById("We Club TARGET").value) +
                    Number(document.getElementById("We Mix TARGET").value) +
                    Number(document.getElementById("We Gold TARGET").value);
                var day = parseInt(document.getElementById("day").value);
                var month = parseInt(document.getElementById("month").value);
                var year = parseInt(document.getElementById("year").value);
                var daysinmonth = new Date(year, month, 0).getDate();
                document.getElementById("Mobile VS").value = Math.round((document.getElementById("Mobile ACH").value / document.getElementById("Mobile TARGET").value) * 100) + "%";
                document.getElementById("Mobile RE").value = Math.round((((document.getElementById("Mobile ACH").value / document.getElementById("Mobile TARGET").value) * 100) / day) * daysinmonth) + "%";
                document.getElementById("We Gold VS").value = Math.round((document.getElementById("We Gold ACH").value / document.getElementById("We Gold TARGET").value) * 100) + "%";
                document.getElementById("We Gold RE").value = Math.round((((document.getElementById("We Gold ACH").value / document.getElementById("We Gold TARGET").value) * 100) / day) * daysinmonth) + "%";
                document.getElementById("ADSL VS").value = Math.round((document.getElementById("ADSL ACH").value / document.getElementById("ADSL TARGET").value) * 100) + "%";
                document.getElementById("ADSL RE").value = Math.round((((document.getElementById("ADSL ACH").value / document.getElementById("ADSL TARGET").value) * 100) / day) * daysinmonth) + "%";
                document.getElementById("Fixed VS").value = Math.round((document.getElementById("Fixed ACH").value / document.getElementById("Fixed TARGET").value) * 100) + "%";
                document.getElementById("Fixed RE").value = Math.round((((document.getElementById("Fixed ACH").value / document.getElementById("Fixed TARGET").value) * 100) / day) * daysinmonth) + "%";
                fetch(ScriptURL, { method: "POST", body: new FormData(Agent) })
                    .then((response) => {
                        Sent();
                    })
                    .catch((error) => (document.getElementById("checkandsubmit").innerHTML = "Error!"));
            });
            function Sent() {
                document.getElementById("checkandsubmit").innerHTML = "Sent";
                another.style.display = "block";
            }
            function Another() {
                another.style.display = "none";
                document.getElementById("checkandsubmit").disabled = false;
                document.getElementById("Agent Name").value = "";
                document.getElementById("PAYG ACH").value = "";
                document.getElementById("Data ACH").value = "";
                document.getElementById("Kix ACH").value = "";
                document.getElementById("Tazbeet ACH").value = "";
                document.getElementById("We Club ACH").value = "";
                document.getElementById("We Mix ACH").value = "";
                document.getElementById("We Gold ACH").value = "";
                document.getElementById("ADSL ACH").value = "";
                document.getElementById("Fixed ACH").value = "";
            }
        </script>
        <br />
        <footer>
            <p class="footer">Developed by: Mamdouh Khalaf (Al Monshah Store Manager)</p>
        </footer>
    </body>
</html>
