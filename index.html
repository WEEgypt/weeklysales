<!DOCTYPE html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
        <title>Weekly Sales</title>
        <link rel="icon" href="icon.png" />
        <link rel="apple-touch-icon" href="icon.png" />
        <link rel="stylesheet" href="style.css" />
    </head>
    <body onload="GetDate()">
        <div class="mainDiv">
            <form method="post" name="Agent" id="Agent">
                <h2>Weekly Sales</h2>
                <table>
                    <tr>
                        <td><label>Sales Till</label></td>
                        <td colspan="2">
                            <table class="date">
                                <tr>
                                    <td>
                                        <select id="day">
                                            <option value="" selected disabled hidden>Day</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                            <option value="11">11</option>
                                            <option value="12">12</option>
                                            <option value="13">13</option>
                                            <option value="14">14</option>
                                            <option value="15">15</option>
                                            <option value="16">16</option>
                                            <option value="17">17</option>
                                            <option value="18">18</option>
                                            <option value="19">19</option>
                                            <option value="20">20</option>
                                            <option value="21">21</option>
                                            <option value="22">22</option>
                                            <option value="23">23</option>
                                            <option value="24">24</option>
                                            <option value="25">25</option>
                                            <option value="26">26</option>
                                            <option value="27">27</option>
                                            <option value="28">28</option>
                                            <option value="29">29</option>
                                            <option value="30">30</option>
                                            <option value="31">31</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select id="month">
                                            <option value="" selected disabled hidden>Month</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="10">10</option>
                                            <option value="11">11</option>
                                            <option value="12">12</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select id="year">
                                            <option value="" selected disabled hidden>Year</option>
                                            <option value="2022">2022</option>
                                            <option value="2023">2023</option>
                                            <option value="2024">2024</option>
                                            <option value="2025">2025</option>
                                            <option value="2026">2026</option>
                                            <option value="2027">2027</option>
                                            <option value="2028">2028</option>
                                            <option value="2029">2029</option>
                                            <option value="2030">2030</option>
                                        </select>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Store</label></td>
                        <td colspan="2">
                            <select name="Store" id="store">
                                <option value="" selected disabled hidden>Store Name</option>
                                <option value="شرق النيل">شرق النيل</option>
                                <option value="نادى التجديف">نادى التجديف</option>
                                <option value="بيت الرحمه">بيت الرحمه</option>
                                <option value="الشهيد">الشهيد</option>
                                <option value="اخميم">اخميم</option>
                                <option value="المنشاه">المنشاه</option>
                                <option value="جرجا - المصريه جروب">جرجا - المصريه جروب</option>
                                <option value="جرجا - فيوتشر">جرجا - فيوتشر</option>
                                <option value="البلينا - فيوتشر">البلينا - فيوتشر</option>
                                <option value="البلينا - تليكوم">البلينا - تليكوم</option>
                                <option value="دار السلام">دار السلام</option>
                                <option value="طهطا - المصريه جروب">طهطا - المصريه جروب</option>
                                <option value="طهطا - فيوتشر">طهطا - فيوتشر</option>
                                <option value="المراغه - المصريه جروب">المراغه - المصريه جروب</option>
                                <option value="المراغه - فيوتشر">المراغه - فيوتشر</option>
                                <option value="طما - فيوتشر">طما - فيوتشر</option>
                                <option value="طما - كافريج">طما - كافريج</option>
                                <option value="مجمع المحاكم">مجمع المحاكم</option>
                                <option value="شارع 15">شارع 15</option>
                                <option value="المخبز الآلي">المخبز الآلي</option>
                                <option value="جهينه">جهينه</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td><label>Agent</label></td>
                        <td colspan="2"><input type="text" class="agentName" name="Agent" id="agent" placeholder="Enter your name" /></td>
                    </tr>
                    <input type="text" name="Date" id="Date" hidden />
                    <tr>
                        <td class="space"></td>
                        <td class="space"></td>
                        <td class="space"></td>
                    </tr>

                    <tr>
                        <td class="header"></td>
                        <td class="header"><b>Achieved</b></td>
                        <td class="header"><b>Target</b></td>
                    </tr>
                    <tr>
                        <td><label>PAYG</label></td>
                        <td><input type="number" name="PAYG ACH" id="PAYG ACH" /></td>
                        <td><input type="number" name="PAYG TARGET" id="PAYG TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>Data</label></td>
                        <td><input type="number" name="Data ACH" id="Data ACH" /></td>
                        <td><input type="number" name="Data TARGET" id="Data TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>Kix</label></td>
                        <td><input type="number" name="Kix ACH" id="Kix ACH" /></td>
                        <td><input type="number" name="Kix TARGET" id="Kix TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>Tazbeet</label></td>
                        <td><input type="number" name="Tazbeet ACH" id="Tazbeet ACH" /></td>
                        <td><input type="number" name="Tazbeet TARGET" id="Tazbeet TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>We Club</label></td>
                        <td><input type="number" name="We Club ACH" id="We Club ACH" /></td>
                        <td><input type="number" name="We Club TARGET" id="We Club TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>We Mix</label></td>
                        <td><input type="number" name="We Mix ACH" id="We Mix ACH" /></td>
                        <td><input type="number" name="We Mix TARGET" id="We Mix TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>Indigo</label></td>
                        <td><input type="number" name="Indigo ACH" id="Indigo ACH" /></td>
                        <td><input type="number" name="Indigo TARGET" id="Indigo TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>ADSL</label></td>
                        <td><input type="number" name="ADSL ACH" id="ADSL ACH" /></td>
                        <td><input type="number" name="ADSL TARGET" id="ADSL TARGET" /></td>
                    </tr>
                    <tr>
                        <td><label>Fixed</label></td>
                        <td><input type="number" name="Fixed ACH" id="Fixed ACH" /></td>
                        <td><input type="number" name="Fixed TARGET" id="Fixed TARGET" /></td>
                    </tr>
                </table>
                <br />
                <input style="display: none;" id="submit" type="submit" value="Submit" />
                <button type="button" id="checkandsubmit" onclick="checkInput()">Submit</button>
                <br />
                <br />
            </form>
        </div>
        <script>
            function GetDate() {
                document.getElementById("day").value = new Date().getDate();
                document.getElementById("month").value = new Date().getMonth() + 1;
                document.getElementById("year").value = new Date().getFullYear();
            }
            function checkInput() {
                if (document.getElementById("store").value == "") {
                    document.getElementById("store").focus();
                    return false;
                } else if (document.getElementById("agent").value == "") {
                    document.getElementById("agent").focus();
                    return false;
                } else if (document.getElementById("PAYG ACH").value == "") {
                    document.getElementById("PAYG ACH").focus();
                    return false;
                } else if (document.getElementById("PAYG TARGET").value == "") {
                    document.getElementById("PAYG TARGET").focus();
                    return false;
                } else if (document.getElementById("Data ACH").value == "") {
                    document.getElementById("Data ACH").focus();
                    return false;
                } else if (document.getElementById("Data TARGET").value == "") {
                    document.getElementById("Data TARGET").focus();
                    return false;
                } else if (document.getElementById("Kix ACH").value == "") {
                    document.getElementById("Kix ACH").focus();
                    return false;
                } else if (document.getElementById("Kix TARGET").value == "") {
                    document.getElementById("Kix TARGET").focus();
                    return false;
                } else if (document.getElementById("Tazbeet ACH").value == "") {
                    document.getElementById("Tazbeet ACH").focus();
                    return false;
                } else if (document.getElementById("Tazbeet TARGET").value == "") {
                    document.getElementById("Tazbeet TARGET").focus();
                    return false;
                } else if (document.getElementById("We Club ACH").value == "") {
                    document.getElementById("We Club ACH").focus();
                    return false;
                } else if (document.getElementById("We Club TARGET").value == "") {
                    document.getElementById("We Club TARGET").focus();
                    return false;
                } else if (document.getElementById("We Mix ACH").value == "") {
                    document.getElementById("We Mix ACH").focus();
                    return false;
                } else if (document.getElementById("We Mix TARGET").value == "") {
                    document.getElementById("We Mix TARGET").focus();
                    return false;
                } else if (document.getElementById("Indigo ACH").value == "") {
                    document.getElementById("Indigo ACH").focus();
                    return false;
                } else if (document.getElementById("Indigo TARGET").value == "") {
                    document.getElementById("Indigo TARGET").focus();
                    return false;
                } else if (document.getElementById("ADSL ACH").value == "") {
                    document.getElementById("ADSL ACH").focus();
                    return false;
                } else if (document.getElementById("ADSL TARGET").value == "") {
                    document.getElementById("ADSL TARGET").focus();
                    return false;
                } else if (document.getElementById("Fixed ACH").value == "") {
                    document.getElementById("Fixed ACH").focus();
                    return false;
                } else if (document.getElementById("Fixed TARGET").value == "") {
                    document.getElementById("Fixed TARGET").focus();
                    return false;
                } else {
                    document.getElementById("submit").click();
                }
            }
            document.getElementById("Agent").onkeypress = function (e) {
                var key = e.charCode || e.keyCode || 0;
                if (key == 13) {
                    e.preventDefault();
                }
            };
            const form1 = document.forms["Agent"];
            form1.addEventListener("submit", (e) => {
                document.getElementById("checkandsubmit").disabled = true;
                document.getElementById("checkandsubmit").innerHTML = "Sending";
                e.preventDefault();
                var scriptURL = "https://script.google.com/macros/s/AKfycbxUyT6Yj1yaHRgtjo9k2VAJQCWIaHlyWhbEsM5KwqiClYgg_82q5V52m1PbJ6mvqHcNvw/exec?sheetName=Weekly";
                document.getElementById("Date").value = document.getElementById("day").value + "/" + document.getElementById("month").value + "/" + document.getElementById("year").value;
                var store = document.getElementById("store").value;
                var agent = document.getElementById("agent").value;
                fetch(scriptURL, { method: "POST", body: new FormData(Agent) })
                    .then((response) => (document.getElementById("checkandsubmit").innerHTML = "Sent"))
                    .catch((error) => (document.getElementById("checkandsubmit").innerHTML = "Error!"));
            });
        </script>
        <br />
        <footer>
            <p class="footer">Developed by: Mamdouh Khalaf (Al Monshah Store Manager)</p>
        </footer>
    </body>
</html>
